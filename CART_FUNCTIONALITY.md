# Функция корзины и добавления товаров

## Описание

Реализована полная функция корзины для ресторанов. Теперь рестораны могут:
- Добавлять товары в корзину прямо из каталога
- Указывать количество товара в килограммах
- Видеть стоимость товара в реальном времени
- Управлять корзиной (изменять количество, удалять товары)
- Просматривать итоговую стоимость заказа

## Функциональность

### Каталог ресторана (`/restaurant/catalog`)

**Изменения:**
- Убрана кнопка "Подробнее"
- Добавлено поле ввода количества товара (в килограммах)
- Добавлено отображение итоговой стоимости при выборе количества
- Кнопка "Добавить в корзину" вместо "Подробнее"

**Как использовать:**
1. Введите количество товара в килограммах
2. При вводе количества автоматически рассчитывается стоимость
3. Нажмите "Добавить в корзину"
4. Товар добавляется в корзину с указанным количеством

### Страница корзины (`/cart`)

**Функции:**
- Просмотр всех товаров в корзине
- Изменение количества товара (кнопки +/-)
- Удаление товара из корзины
- Просмотр итоговой стоимости
- Просмотр общего веса товаров
- Кнопка "Оформить заказ" (подготовка к будущей функции)
- Кнопка "Продолжить покупки" для возврата в каталог

**Отображение информации:**
- Фотография товара
- Название товара
- Цена за килограмм
- Текущее количество в килограммах
- Итоговая стоимость товара
- Общая стоимость заказа

## Реализация

### API мутации (convex/cart.ts)

- `addToCart` - добавление товара в корзину
- `updateCartItem` - изменение количества товара
- `removeFromCart` - удаление товара из корзины
- `clearCart` - очистка корзины
- `getCart` - получение корзины пользователя

### Защита маршрутов

- Маршрут `/cart` защищен middleware
- Требуется авторизация для доступа к корзине
- Неавторизованные пользователи перенаправляются на страницу входа

### UI компоненты

- Обновлен каталог ресторана с функцией добавления в корзину
- Создана полнофункциональная страница корзины
- Добавлена ссылка на корзину в меню сайдбара ресторана

## Использование

### Добавление товара в корзину

1. Перейдите в "Каталог" из меню
2. Введите количество товара в килограммах
3. Нажмите "Добавить в корзину"
4. Товар добавится в корзину

### Просмотр корзины

1. Нажмите "Корзина" в меню сайдбара
2. Просмотрите все товары в корзине
3. Измените количество товара при необходимости
4. Удалите товар, если нужно

### Оформление заказа

1. Перейдите в корзину
2. Проверьте товары и количество
3. Нажмите "Оформить заказ" (функция в разработке)

## Технические детали

### Структура данных корзины

```typescript
{
  userId: string,
  items: [
    {
      productId: string,
      quantity: number,  // в килограммах
      price: number,     // цена за килограмм
      product?: {        // информация о товаре
        _id: string,
        name: string,
        image: string,
        slug: string
      }
    }
  ],
  updatedAt: number
}
```

### Расчет стоимости

- Стоимость товара = количество (кг) × цена за кг
- Итоговая стоимость = сумма стоимостей всех товаров

## Будущие улучшения

- Оформление заказа
- История заказов
- Сохранение корзины при выходе
- Уведомления о наличии товара
- Применение скидок и промокодов

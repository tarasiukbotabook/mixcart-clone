# Поток авторизации в HubFood

## Как работает авторизация

### 1. Регистрация
- Пользователь выбирает тип аккаунта (Ресторан или Поставщик)
- Заполняет форму: email, телефон, пароль
- Система создает пользователя в базе данных
- Генерируется токен сессии
- Токен сохраняется в `localStorage` и `cookies`
- Пользователь перенаправляется на главную страницу

### 2. Вход
- Пользователь вводит email и пароль
- Система проверяет учетные данные
- Если верно, генерируется новый токен сессии
- Токен сохраняется в `localStorage` и `cookies`
- Пользователь перенаправляется на главную страницу

### 3. Главная страница (/)
- При загрузке проверяется наличие токена в `localStorage`
- Если токен есть, система запрашивает данные пользователя с сервера
- Если пользователь авторизован:
  - Показывается приветствие с именем пользователя
  - Показывается тип аккаунта (Ресторан/Поставщик)
  - Доступна кнопка "Выход"
  - Доступна кнопка "Личный кабинет"
- Если пользователь не авторизован:
  - Показывается стандартная главная страница
  - Доступны кнопки "Вход" и "Регистрация"

### 4. Выход
- Пользователь нажимает кнопку "Выход"
- Токен удаляется из базы данных
- Токен удаляется из `localStorage` и `cookies`
- Пользователь остается на главной странице
- Главная страница обновляется и показывает неавторизованное состояние

### 5. Защищенные маршруты
- `/dashboard` - требует авторизации
- `/supplier/*` - требует авторизации
- `/orders` - требует авторизации

Если пользователь попытается получить доступ к защищенному маршруту без авторизации, он будет перенаправлен на `/auth/login`.

## Хранение токена

Токен хранится в двух местах:
1. **localStorage** - для доступа из JavaScript
2. **cookies** - для доступа из middleware

Это обеспечивает надежность авторизации даже при перезагрузке страницы.

## Сессии

- Каждая сессия имеет срок действия 30 дней
- При входе создается новая сессия
- При выходе сессия удаляется
- Истекшие сессии автоматически удаляются

## Безопасность

- Пароли хешируются перед сохранением в базу данных
- Токены генерируются случайным образом
- Токены передаются только через HTTPS (в production)
